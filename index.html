<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); overflow: hidden; }
        .header { background: linear-gradient(135deg, #2c3e50, #34495e); color: white; padding: 25px; text-align: center; }
        .header h1 { font-size: 2.2em; margin-bottom: 10px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; padding: 25px; background: #f8f9fa; }
        .stat-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); text-align: center; border-left: 5px solid; }
        .stat-card.blue { border-color: #3498db; } .stat-card.purple { border-color: #9b59b6; }
        .stat-card.green { border-color: #2ecc71; } .stat-card.orange { border-color: #e67e22; }
        .stat-number { font-size: 2.5em; font-weight: bold; margin: 10px 0; }
        .blue-text { color: #3498db; } .purple-text { color: #9b59b6; } .green-text { color: #2ecc71; } .orange-text { color: #e67e22; } .red-text { color: #e74c3c; }
        .controls { padding: 25px; background: white; border-bottom: 1px solid #eee; }
        .input-group { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr auto; gap: 15px; margin-bottom: 20px; }
        @media (max-width: 768px) { .input-group { grid-template-columns: 1fr; } .stats-grid { grid-template-columns: 1fr; } .header h1 { font-size: 1.8em; } .stat-number { font-size: 2em; } }
        input, select, button { padding: 12px 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; }
        button { background: #3498db; color: white; border: none; cursor: pointer; } button:hover { background: #2980b9; }
        .clear-btn { background: #e74c3c; margin-top: 10px; } .clear-btn:hover { background: #c0392b; }
        .transactions { padding: 25px; } .transaction-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .transaction-table th, .transaction-table td { padding: 15px; text-align: center; border-bottom: 1px solid #eee; }
        .transaction-table th { background: #34495e; color: white; }
        .normal { background: #ebf5fb; border-left: 4px solid #3498db; }
        .flexy { background: #f4ecf7; border-left: 4px solid #9b59b6; }
        .type-badge { padding: 5px 12px; border-radius: 20px; color: white; font-size: 14px; }
        .type-normal { background: #3498db; } .type-flexy { background: #9b59b6; }
        .price-display { background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px; text-align: center; }
        .flexy-price { color: #9b59b6; font-weight: bold; }
        .normal-price { color: #3498db; font-weight: bold; }
        .profit-display { color: #2ecc71; font-weight: bold; font-size: 1.2em; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header"><h1>ğŸš€ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h1><p>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø­ÙŠØ© ÙˆØªÙ‚Ø§Ø±ÙŠØ± Ù…ÙØµÙ„Ø©</p></div>
        
        <div class="stats-grid">
            <div class="stat-card blue"><h3>ğŸŸ¦ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©</h3><div class="stat-number blue-text" id="normalSales">0 Ø¯ÙŠÙ†Ø§Ø±</div><p id="normalCount">0 Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹</p></div>
            <div class="stat-card purple"><h3>ğŸŸª Ù…Ø¨ÙŠØ¹Ø§Øª ÙÙ„ÙŠÙƒØ³ÙŠ</h3><div class="stat-number purple-text" id="flexySales">0 Ø¯ÙŠÙ†Ø§Ø±</div><p id="flexyCount">0 Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹</p></div>
            <div class="stat-card green"><h3>ğŸ’° Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h3><div class="stat-number green-text" id="dailyProfit">0 Ø¯ÙŠÙ†Ø§Ø±</div><p id="dailyCount">0 Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ÙŠÙˆÙ…</p></div>
            <div class="stat-card orange"><h3>ğŸ“ˆ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠ</h3><div class="stat-number orange-text" id="monthlyProfit">0 Ø¯ÙŠÙ†Ø§Ø±</div><p id="monthlyCount">0 Ø¹Ù…Ù„ÙŠØ© Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</p></div>
        </div>
        
        <div class="controls">
            <h3>â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹ Ø¬Ø¯ÙŠØ¯Ø©</h3>
            
            <div class="input-group">
                <input type="number" id="usdPrice" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± (Ù…Ø«Ø§Ù„: 1)" step="0.01" oninput="calculateProfit()">
                <input type="number" id="exchangeRate" value="255" placeholder="Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù" step="0.01" oninput="calculateProfit()">
                <input type="number" id="productPrice" placeholder="Ø³Ø¹Ø± Ø§Ù„Ù…Ù†ØªØ¬ (Ø¯ÙŠÙ†Ø§Ø±)" step="0.01" oninput="calculateProfit()">
                <select id="paymentType" onchange="calculateProfit()">
                    <option value="normal">Ø¯ÙØ¹ Ø¹Ø§Ø¯ÙŠ (ccp/baridi/ÙŠØ¯ Ø¨ÙŠØ¯)</option>
                    <option value="flexy">Ø¯ÙØ¹ ÙÙ„ÙŠÙƒØ³ÙŠ</option>
                </select>
                <button onclick="addTransaction()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</button>
            </div>
            
            <div class="price-display">
                <div id="profitCalculation">
                    â† Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù„Ø±Ø¤ÙŠØ© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø­
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <button class="clear-btn" onclick="clearAllData()">Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            </div>
        </div>
        
        <div class="transactions">
            <h3>ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h3>
            <table class="transaction-table">
                <thead>
                    <tr>
                        <th>#</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø³Ø¹Ø± $</th><th>Ø§Ù„ØªÙƒÙ„ÙØ©</th>
                        <th>Ø³Ø¹Ø± Ø§Ù„Ù…Ù†ØªØ¬</th><th>Ø§Ù„Ø±Ø¨Ø­</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    </tr>
                </thead>
                <tbody id="transactionsBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        console.log("ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…...");
        let exchangeRate = 255;
        let transactions = JSON.parse(localStorage.getItem('salesTransactions')) || [];
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log("âœ… HTML Ù…Ø­Ù…Ù„");
            updateAll();
        });
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        function calculateProfit() {
            const usdPrice = parseFloat(document.getElementById('usdPrice').value) || 0;
            const rate = parseFloat(document.getElementById('exchangeRate').value) || exchangeRate;
            const productPrice = parseFloat(document.getElementById('productPrice').value) || 0;
            const paymentType = document.getElementById('paymentType').value;
            
            if (usdPrice <= 0 || productPrice <= 0) {
                document.getElementById('profitCalculation').innerHTML = 
                    '<span style="color: #666;">â† Ø£Ø¯Ø®Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù„Ø±Ø¤ÙŠØ© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø­</span>';
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù
            exchangeRate = rate;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ©
            let cost, profit, calculationText;
            
            if (paymentType === 'flexy') {
                // Ø­Ø³Ø§Ø¨ ÙÙ„ÙŠÙƒØ³ÙŠ: (Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± Ã— Ø§Ù„ØµØ±Ù) Ã· 0.82
                cost = (usdPrice * rate) / 0.82;
                profit = productPrice - cost;
                calculationText = `
                    <div>ğŸ’° <span class="normal-price">Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©:</span> ${formatNumber(usdPrice * rate)} Ø¯ÙŠÙ†Ø§Ø±</div>
                    <div>ğŸ’³ <span class="flexy-price">Ø§Ù„ØªÙƒÙ„ÙØ© Ø¨ÙÙ„ÙŠÙƒØ³ÙŠ:</span> ${formatNumber(cost)} Ø¯ÙŠÙ†Ø§Ø±</div>
                    <div>ğŸ·ï¸ <span>Ø³Ø¹Ø± Ø§Ù„Ù…Ù†ØªØ¬:</span> ${formatNumber(productPrice)} Ø¯ÙŠÙ†Ø§Ø±</div>
                    <div class="profit-display">ğŸ¤‘ Ø§Ù„Ø±Ø¨Ø­: ${formatNumber(profit)} Ø¯ÙŠÙ†Ø§Ø±</div>
                    <div style="font-size: 14px; color: #666; margin-top: 5px;">
                        (Ø§Ù„Ø­Ø³Ø§Ø¨: (${usdPrice} Ã— ${rate}) Ã· 0.82 = ${formatNumber(cost)} â† ${formatNumber(productPrice)} - ${formatNumber(cost)} = ${formatNumber(profit)})
                    </div>
                `;
            } else {
                // Ø­Ø³Ø§Ø¨ Ø¹Ø§Ø¯ÙŠ: Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± Ã— Ø§Ù„ØµØ±Ù
                cost = usdPrice * rate;
                profit = productPrice - cost;
                calculationText = `
                    <div>ğŸ’° <span class="normal-price">Ø§Ù„ØªÙƒÙ„ÙØ©:</span> ${formatNumber(cost)} Ø¯ÙŠÙ†Ø§Ø±</div>
                    <div>ğŸ·ï¸ <span>Ø³Ø¹Ø± Ø§Ù„Ù…Ù†ØªØ¬:</span> ${formatNumber(productPrice)} Ø¯ÙŠÙ†Ø§Ø±</div>
                    <div class="profit-display">ğŸ¤‘ Ø§Ù„Ø±Ø¨Ø­: ${formatNumber(profit)} Ø¯ÙŠÙ†Ø§Ø±</div>
                    <div style="font-size: 14px; color: #666; margin-top: 5px;">
                        (Ø§Ù„Ø­Ø³Ø§Ø¨: ${usdPrice} Ã— ${rate} = ${formatNumber(cost)} â† ${formatNumber(productPrice)} - ${formatNumber(cost)} = ${formatNumber(profit)})
                    </div>
                `;
            }
            
            document.getElementById('profitCalculation').innerHTML = calculationText;
        }
        
        // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø´ÙŠØ¡
        function updateAll() {
            updateStatistics();
            updateTransactionsTable();
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
        function addTransaction() {
            const usdPrice = parseFloat(document.getElementById('usdPrice').value);
            const productPrice = parseFloat(document.getElementById('productPrice').value);
            const paymentType = document.getElementById('paymentType').value;
            
            if (!usdPrice || usdPrice <= 0 || !productPrice || productPrice <= 0) {
                alert('âš ï¸ Ø£Ø¯Ø®Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±');
                return;
            }
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ© ÙˆØ§Ù„Ø±Ø¨Ø­
            let cost, profit;
            
            if (paymentType === 'flexy') {
                // Ø­Ø³Ø§Ø¨ ÙÙ„ÙŠÙƒØ³ÙŠ
                cost = (usdPrice * exchangeRate) / 0.82;
                profit = productPrice - cost;
            } else {
                // Ø­Ø³Ø§Ø¨ Ø¹Ø§Ø¯ÙŠ
                cost = usdPrice * exchangeRate;
                profit = productPrice - cost;
            }
            
            const transaction = {
                id: transactions.length + 1,
                type: paymentType,
                usdPrice: usdPrice,
                cost: cost,           // Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø©
                productPrice: productPrice, // Ø³Ø¹Ø± Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø¯Ø®Ù„
                profit: profit,       // Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨
                date: new Date().toLocaleString('en-US'),
                day: new Date().toDateString(),
                month: new Date().getMonth() + '-' + new Date().getFullYear()
            };
            
            transactions.push(transaction);
            localStorage.setItem('salesTransactions', JSON.stringify(transactions));
            updateAll();
            
            // ØªÙØ±ÙŠØº Ø§Ù„Ø­Ù‚ÙˆÙ„
            document.getElementById('usdPrice').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('profitCalculation').innerHTML = 
                '<span style="color: #666;">â† Ø£Ø¯Ø®Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù„Ø±Ø¤ÙŠØ© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø­</span>';
            
            alert(`âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©!
ğŸ’µ Ø§Ù„Ø³Ø¹Ø±: ${usdPrice}$
ğŸ·ï¸ Ø§Ù„Ù…Ù†ØªØ¬: ${formatNumber(productPrice)} Ø¯ÙŠÙ†Ø§Ø±
ğŸ’° Ø§Ù„ØªÙƒÙ„ÙØ©: ${formatNumber(cost)} Ø¯ÙŠÙ†Ø§Ø±
ğŸ¤‘ Ø§Ù„Ø±Ø¨Ø­: ${formatNumber(profit)} Ø¯ÙŠÙ†Ø§Ø±`);
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStatistics() {
            const today = new Date().toDateString();
            const currentMonth = new Date().getMonth() + '-' + new Date().getFullYear();
            
            let dailyProfit = 0, monthlyProfit = 0, normalSales = 0, flexySales = 0;
            let dailyCount = 0, monthlyCount = 0, normalCount = 0, flexyCount = 0;
            
            transactions.forEach(t => {
                if (t.day === today) {
                    dailyProfit += t.profit;
                    dailyCount++;
                }
                
                if (t.month === currentMonth) {
                    monthlyProfit += t.profit;
                    monthlyCount++;
                }
                
                if (t.type === 'normal') {
                    normalSales += t.productPrice;
                    normalCount++;
                } else {
                    flexySales += t.productPrice;
                    flexyCount++;
                }
            });
            
            // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
            const format = (num) => {
                if (!num && num !== 0) return '0';
                return num.toLocaleString('en-US');
            };
            
            document.getElementById('dailyProfit').textContent = format(dailyProfit) + ' Ø¯ÙŠÙ†Ø§Ø±';
            document.getElementById('monthlyProfit').textContent = format(monthlyProfit) + ' Ø¯ÙŠÙ†Ø§Ø±';
            document.getElementById('normalSales').textContent = format(normalSales) + ' Ø¯ÙŠÙ†Ø§Ø±';
            document.getElementById('flexySales').textContent = format(flexySales) + ' Ø¯ÙŠÙ†Ø§Ø±';
            document.getElementById('dailyCount').textContent = dailyCount + ' Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ÙŠÙˆÙ…';
            document.getElementById('monthlyCount').textContent = monthlyCount + ' Ø¹Ù…Ù„ÙŠØ© Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±';
            document.getElementById('normalCount').textContent = normalCount + ' Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹';
            document.getElementById('flexyCount').textContent = flexyCount + ' Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹';
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„
        function updateTransactionsTable() {
            const tbody = document.getElementById('transactionsBody');
            if (!tbody) { console.error("âŒ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…ÙÙ‚ÙˆØ¯"); return; }
            
            tbody.innerHTML = '';
            [...transactions].reverse().forEach(t => {
                const row = document.createElement('tr');
                row.className = t.type === 'normal' ? 'normal' : 'flexy';
                const profitClass = t.profit >= 0 ? 'green-text' : 'red-text';
                const profitSign = t.profit >= 0 ? '+' : '';
                
                // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
                const formatNum = (num) => num.toLocaleString('en-US');
                
                row.innerHTML = `
                    <td>${t.id}</td>
                    <td><span class="type-badge type-${t.type}">${t.type === 'normal' ? 'Ø¹Ø§Ø¯ÙŠ' : 'ÙÙ„ÙŠÙƒØ³ÙŠ'}</span></td>
                    <td>${t.usdPrice} $</td>
                    <td>${formatNum(Math.round(t.cost))} Ø¯ÙŠÙ†Ø§Ø±</td>
                    <td>${formatNum(t.productPrice)} Ø¯ÙŠÙ†Ø§Ø±</td>
                    <td class="${profitClass}">${profitSign}${formatNum(Math.round(t.profit))} Ø¯ÙŠÙ†Ø§Ø±</td>
                    <td>${t.date}</td>`;
                tbody.appendChild(row);
            });
        }
        
        // Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function clearAllData() {
            if (confirm('âš ï¸ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                localStorage.removeItem('salesTransactions');
                transactions = [];
                updateAll();
                alert('ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
        function formatNumber(num) {
            if (!num && num !== 0) return '0';
            return Math.round(num).toLocaleString('en-US');
        }
        
        console.log("ğŸ¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø²!");
    </script>
</body>
</html>